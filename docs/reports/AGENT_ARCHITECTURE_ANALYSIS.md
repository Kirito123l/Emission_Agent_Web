# EmissionAgent æ¶æ„æ·±åº¦åˆ†ææŠ¥å‘Š

ç”Ÿæˆæ—¶é—´: 2026-01-29

## ç›®å½•
1. [å½“å‰æ¶æ„æ¦‚è§ˆ](#å½“å‰æ¶æ„æ¦‚è§ˆ)
2. [å„æœºåˆ¶è¯¦ç»†åˆ†æ](#å„æœºåˆ¶è¯¦ç»†åˆ†æ)
3. [ä¸ChatGPTå¯¹æ¯”](#ä¸chatgptå¯¹æ¯”)
4. [æ ¸å¿ƒé—®é¢˜è¯Šæ–­](#æ ¸å¿ƒé—®é¢˜è¯Šæ–­)
5. [ä¼˜åŒ–è·¯çº¿å›¾](#ä¼˜åŒ–è·¯çº¿å›¾)

---

## å½“å‰æ¶æ„æ¦‚è§ˆ

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·è¾“å…¥ (User Input)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   EmissionAgent (ä¸»æ§)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. å›é¡¾æ€§æŸ¥è¯¢æ£€æµ‹ (_is_retrospective_query)           â”‚  â”‚
â”‚  â”‚ 2. Planning + éªŒè¯ + åæ€ä¿®å¤ (_plan_with_validation) â”‚  â”‚
â”‚  â”‚ 3. è¿½é—®æ£€æŸ¥ (needs_clarification)                     â”‚  â”‚
â”‚  â”‚ 4. æŠ€èƒ½æ‰§è¡Œ (_execute_plan)                           â”‚  â”‚
â”‚  â”‚ 5. å›ç­”åˆæˆ (_synthesize)                             â”‚  â”‚
â”‚  â”‚ 6. å­¦ä¹ è®°å½• (_record_learning)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Context    â”‚ â”‚   Validator  â”‚ â”‚  Reflector   â”‚
â”‚ å¯¹è¯ä¸Šä¸‹æ–‡    â”‚ â”‚   è®¡åˆ’éªŒè¯    â”‚ â”‚   åæ€ä¿®å¤    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Learner   â”‚ â”‚    Monitor   â”‚ â”‚     Cache    â”‚
â”‚   å­¦ä¹ æœºåˆ¶    â”‚ â”‚   æ€§èƒ½ç›‘æ§    â”‚ â”‚   ç¼“å­˜æœºåˆ¶    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶èŒè´£

| ç»„ä»¶ | èŒè´£ | æ–‡ä»¶ |
|------|------|------|
| **EmissionAgent** | ä¸»æ§é€»è¾‘ï¼Œåè°ƒæ•´ä¸ªæµç¨‹ | `agent/core.py` |
| **ConversationContext** | å¯¹è¯å†å²ç®¡ç†ï¼Œå‚æ•°åˆå¹¶ | `agent/context.py` |
| **PlanValidator** | éªŒè¯Planningè¾“å‡ºï¼Œè‡ªåŠ¨ä¿®æ­£ | `agent/validator.py` |
| **PlanReflector** | åˆ†æé”™è¯¯å¹¶è‡ªåŠ¨ä¿®å¤ | `agent/reflector.py` |
| **AgentLearner** | ä»æ¡ˆä¾‹ä¸­å­¦ä¹ ï¼Œç”Ÿæˆç¤ºä¾‹ | `agent/learner.py` |
| **AgentMonitor** | æ€§èƒ½ç›‘æ§ï¼Œå¼‚å¸¸æ£€æµ‹ | `agent/monitor.py` |
| **PlanningCache** | ç¼“å­˜Planningç»“æœ | `agent/cache.py` |

---

## å„æœºåˆ¶è¯¦ç»†åˆ†æ

### 1. Planning æœºåˆ¶

#### å·¥ä½œæµç¨‹
```
ç”¨æˆ·è¾“å…¥
  â†“
æ£€æŸ¥å›é¡¾æ€§æŸ¥è¯¢ â†’ æ˜¯ â†’ ç›´æ¥è¿”å›å†å²ç»“æœ
  â†“ å¦
è°ƒç”¨ LLM ç”Ÿæˆè®¡åˆ’ (ç¬¬1æ¬¡)
  â†“
å‚æ•°åˆå¹¶ (merge_params) - ä»å†å²è¡¥å……å‚æ•°
  â†“
éªŒè¯ (validate)
  â†“
éªŒè¯é€šè¿‡? â†’ æ˜¯ â†’ æ‰§è¡ŒæŠ€èƒ½
  â†“ å¦
åæ€ä¿®å¤ (reflect_and_fix) - æœ€å¤š2æ¬¡
  â†“
é‡æ–°éªŒè¯
  â†“
å¤±è´¥ â†’ è¿”å›å‹å¥½é”™è¯¯
```

#### å½“å‰å®ç°ä¼˜ç‚¹
âœ… **å‚æ•°åˆå¹¶æœºåˆ¶**: æ”¯æŒå¢é‡å¯¹è¯ï¼Œç”¨æˆ·å¯ä»¥é€æ­¥è¡¥å……å‚æ•°
âœ… **å¤šå±‚éªŒè¯**: ç»“æ„éªŒè¯ã€ç±»å‹éªŒè¯ã€è¯­ä¹‰éªŒè¯
âœ… **è‡ªåŠ¨å­—æ®µä¿®æ­£**: è‡ªåŠ¨ä¿®æ­£å¸¸è§å­—æ®µåé”™è¯¯
âœ… **ç¼“å­˜æœºåˆ¶**: é¿å…é‡å¤LLMè°ƒç”¨

#### å½“å‰å®ç°ç¼ºç‚¹
âŒ **ä¸²è¡Œé‡è¯•**: å¤±è´¥åä¸²è¡Œé‡è¯•2æ¬¡ï¼Œå»¶è¿Ÿé«˜ï¼ˆ34ç§’ï¼‰
âŒ **å•æ¬¡LLMè°ƒç”¨**: æ²¡æœ‰æ€ç»´é“¾ï¼ˆChain of Thoughtï¼‰
âŒ **ç¼ºå°‘ç¤ºä¾‹é©±åŠ¨**: æ²¡æœ‰åˆ©ç”¨å­¦ä¹ çš„å†å²æ¡ˆä¾‹
âŒ **ä¸Šä¸‹æ–‡çª—å£æµªè´¹**: æ¯æ¬¡é‡è¯•éƒ½é‡å¤å‘é€å®Œæ•´ä¸Šä¸‹æ–‡

### 2. åæ€æœºåˆ¶ (Reflection)

#### å·¥ä½œæµç¨‹
```
éªŒè¯å¤±è´¥
  â†“
é”™è¯¯åˆ†ç±» (field_name / type_error / missing_field / semantic)
  â†“
å¯ä»¥ç”¨è§„åˆ™ä¿®å¤? â†’ æ˜¯ â†’ è§„åˆ™ä¿®å¤ï¼ˆå¿«é€Ÿï¼‰
  â†“ å¦
LLMä¿®å¤ (æ™ºèƒ½ä½†æ…¢)
  â†“
ä¿®å¤æˆåŠŸ? â†’ æ˜¯ â†’ è¿”å›ä¿®å¤åçš„è®¡åˆ’
  â†“ å¦
è¿”å›å¤±è´¥
```

#### å½“å‰å®ç°ä¼˜ç‚¹
âœ… **åˆ†å±‚ç­–ç•¥**: è§„åˆ™ä¿®å¤ï¼ˆå¿«ï¼‰+ LLMä¿®å¤ï¼ˆæ™ºèƒ½ï¼‰
âœ… **é”™è¯¯åˆ†ç±»**: æ ¹æ®é”™è¯¯ç±»å‹é€‰æ‹©ä¿®å¤ç­–ç•¥
âœ… **Schemaé©±åŠ¨**: åŸºäºSkill Schemaç”Ÿæˆä¿®å¤Prompt

#### å½“å‰å®ç°ç¼ºç‚¹
âŒ **ä¿®å¤Prompté™æ€**: ç¡¬ç¼–ç å¸¸è§é”™è¯¯ï¼Œæ²¡æœ‰åŠ¨æ€å­¦ä¹ 
âŒ **ç¼ºå°‘Few-shot**: æ²¡æœ‰åˆ©ç”¨Learnerç”Ÿæˆçš„å†å²ç¤ºä¾‹
âŒ **ä¿®å¤å¤±è´¥æ— fallback**: ä¿®å¤å¤±è´¥åç›´æ¥æ”¾å¼ƒï¼Œæ²¡æœ‰å¤‡é€‰æ–¹æ¡ˆ
âŒ **æ²¡æœ‰ä¿®å¤éªŒè¯**: ä¿®å¤åä¸éªŒè¯ï¼Œå¯èƒ½å¼•å…¥æ–°é”™è¯¯

### 3. å­¦ä¹ æœºåˆ¶ (Learning)

#### å·¥ä½œæµç¨‹
```
æ‰§è¡Œå®Œæˆ
  â†“
è®°å½•æ¡ˆä¾‹ (user_input, plan, result, errors)
  â†“
æˆåŠŸä¸”è®¡åˆ’è¢«ä¿®å¤? â†’ æ˜¯ â†’ æå–ä¸ºæ–°ç¤ºä¾‹
  â†“
å¤±è´¥? â†’ æ˜¯ â†’ æ›´æ–°é”™è¯¯æ¨¡å¼ç»Ÿè®¡
  â†“
æŒä¹…åŒ–åˆ°ç£ç›˜
```

#### å½“å‰å®ç°ä¼˜ç‚¹
âœ… **æ¡ˆä¾‹æŒä¹…åŒ–**: ä¿å­˜æ‰€æœ‰æ¡ˆä¾‹åˆ°JSONLæ–‡ä»¶
âœ… **é”™è¯¯æ¨¡å¼æŒ–æ˜**: ç»Ÿè®¡å¸¸è§é”™è¯¯ï¼Œå»ºè®®Promptæ”¹è¿›
âœ… **ç¤ºä¾‹ç”Ÿæˆ**: è‡ªåŠ¨ç”ŸæˆFew-shotç¤ºä¾‹

#### å½“å‰å®ç°ç¼ºç‚¹
âŒ **å­¦ä¹ æœªè¢«ä½¿ç”¨**: Learneræ”¶é›†äº†æ•°æ®ï¼Œä½†Planningæ²¡æœ‰ä½¿ç”¨
âŒ **ç¤ºä¾‹ç›¸ä¼¼åº¦ç²—ç³™**: åŸºäºè¯é¢‘çš„ç®€å•ç›¸ä¼¼åº¦ï¼Œä¸å‡†ç¡®
âŒ **æ²¡æœ‰ä¸»åŠ¨å­¦ä¹ **: åªæ˜¯è¢«åŠ¨è®°å½•ï¼Œæ²¡æœ‰ä¸»åŠ¨ä¼˜åŒ–
âŒ **ç¼ºå°‘åé¦ˆå¾ªç¯**: æ²¡æœ‰A/Bæµ‹è¯•éªŒè¯å­¦ä¹ æ•ˆæœ

### 4. å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†

#### å½“å‰å®ç°ä¼˜ç‚¹
âœ… **å‚æ•°å¿«ç…§**: ä¿å­˜æ¯ä¸ªSkillçš„å‚æ•°å¿«ç…§
âœ… **æ™ºèƒ½åˆå¹¶**: æ ¹æ®Skillç±»å‹åˆå¹¶å‚æ•°
âœ… **ä¸Šä¸‹æ–‡çª—å£**: é™åˆ¶æœ€å¤šä¿å­˜20è½®å¯¹è¯

#### å½“å‰å®ç°ç¼ºç‚¹
âŒ **ç¼ºå°‘æ‘˜è¦**: é•¿å¯¹è¯æ²¡æœ‰æ‘˜è¦ï¼Œä¸¢å¤±æ—©æœŸä¿¡æ¯
âŒ **ç¼ºå°‘é‡è¦æ€§è¯„åˆ†**: æ‰€æœ‰å†å²ç­‰åŒå¯¹å¾…ï¼Œæ²¡æœ‰ä¼˜å…ˆçº§
âŒ **ç¼ºå°‘å¤šè½®æ¨ç†**: ä¸èƒ½è·¨å¤šè½®å¯¹è¯è¿›è¡Œæ¨ç†

### 5. æ€§èƒ½ç›‘æ§

#### å½“å‰å®ç°ä¼˜ç‚¹
âœ… **å¤šç»´æŒ‡æ ‡**: æˆåŠŸç‡ã€å»¶è¿Ÿã€Planningå°è¯•æ¬¡æ•°
âœ… **å¼‚å¸¸æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹æ€§èƒ½å¼‚å¸¸
âœ… **æŒ‰Skillåˆ†ç»„**: ç»Ÿè®¡æ¯ä¸ªSkillçš„æ€§èƒ½

#### å½“å‰å®ç°ç¼ºç‚¹
âŒ **å†…å­˜é™åˆ¶**: åªä¿å­˜æœ€è¿‘1000æ¡ï¼Œå†å²æ•°æ®ä¸¢å¤±
âŒ **ç¼ºå°‘æŒä¹…åŒ–**: é‡å¯åç›‘æ§æ•°æ®æ¸…ç©º
âŒ **ç¼ºå°‘è¶‹åŠ¿åˆ†æ**: ä¸èƒ½åˆ†ææ€§èƒ½è¶‹åŠ¿
âŒ **ç¼ºå°‘å‘Šè­¦æœºåˆ¶**: æ£€æµ‹åˆ°å¼‚å¸¸ä½†æ²¡æœ‰ä¸»åŠ¨å‘Šè­¦

---

## ä¸ChatGPTå¯¹æ¯”

### ChatGPTçš„æ ¸å¿ƒä¼˜åŠ¿

| ç‰¹æ€§ | ChatGPT | å½“å‰Agent | å·®è· |
|------|---------|----------|------|
| **æ€ç»´é“¾** | âœ… å¤šæ­¥æ¨ç† | âŒ å•æ¬¡Planning | ğŸ”´ å¤§ |
| **Few-shotå­¦ä¹ ** | âœ… åŠ¨æ€ç¤ºä¾‹ | âš ï¸ æ”¶é›†ä½†æœªç”¨ | ğŸ”´ å¤§ |
| **è‡ªæˆ‘åæ€** | âœ… å¤šè½®åæ€ | âš ï¸ å•æ¬¡åæ€ | ğŸŸ¡ ä¸­ |
| **å¹¶è¡Œå¤„ç†** | âœ… å¹¶è¡Œç”Ÿæˆå¤šä¸ªæ–¹æ¡ˆ | âŒ ä¸²è¡Œé‡è¯• | ğŸŸ¡ ä¸­ |
| **ä¸Šä¸‹æ–‡å‹ç¼©** | âœ… æ™ºèƒ½æ‘˜è¦ | âŒ æ— æ‘˜è¦ | ğŸŸ¡ ä¸­ |
| **ä¸»åŠ¨å­¦ä¹ ** | âœ… RLHF | âŒ è¢«åŠ¨è®°å½• | ğŸ”´ å¤§ |
| **å¤šæ¨¡æ€** | âœ… å›¾æ–‡éŸ³è§† | âŒ ä»…æ–‡æœ¬ | ğŸ”´ å¤§ |
| **å·¥å…·è°ƒç”¨** | âœ… Function Calling | âœ… Skillæ‰§è¡Œ | ğŸŸ¢ å° |

### å…³é”®å·®è·åˆ†æ

#### 1. **æ€ç»´é“¾ (Chain of Thought)** ğŸ”´
**ChatGPTçš„åšæ³•**:
- å…ˆæ€è€ƒ"æˆ‘éœ€è¦åˆ†å‡ æ­¥è§£å†³è¿™ä¸ªé—®é¢˜"
- æ¯ä¸€æ­¥æ˜ç¡®è¯´æ˜æ¨ç†è¿‡ç¨‹
- æœ€åç»¼åˆå¾—å‡ºç­”æ¡ˆ

**å½“å‰Agent**:
- ç›´æ¥ç”Ÿæˆæœ€ç»ˆè®¡åˆ’
- æ²¡æœ‰ä¸­é—´æ¨ç†è¿‡ç¨‹
- å¤±è´¥åä¸çŸ¥é“å“ªé‡Œå‡ºé”™

**å½±å“**:
- å¤æ‚ä»»åŠ¡å®¹æ˜“å‡ºé”™
- è°ƒè¯•å›°éš¾
- ç”¨æˆ·ä¸ç†è§£Agentçš„æ€è€ƒè¿‡ç¨‹

#### 2. **Few-shotå­¦ä¹ ** ğŸ”´
**ChatGPTçš„åšæ³•**:
- åŠ¨æ€æ£€ç´¢ç›¸å…³ç¤ºä¾‹
- åœ¨Promptä¸­åŒ…å«3-5ä¸ªæœ€ç›¸å…³çš„ä¾‹å­
- ç¤ºä¾‹æ¥è‡ªç”¨æˆ·åé¦ˆå’ŒæˆåŠŸæ¡ˆä¾‹

**å½“å‰Agent**:
- Learneræ”¶é›†äº†ç¤ºä¾‹ï¼Œä½†Planningæ²¡æœ‰ä½¿ç”¨
- æ¯æ¬¡éƒ½ä»é›¶å¼€å§‹
- é‡å¤çŠ¯åŒæ ·çš„é”™è¯¯

**å½±å“**:
- æ— æ³•ä»å†å²ä¸­å­¦ä¹ 
- é”™è¯¯ç‡å±…é«˜ä¸ä¸‹
- ä¸é€‚åº”ç‰¹å®šç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯

#### 3. **å¹¶è¡Œå¤„ç†** ğŸŸ¡
**ChatGPTçš„åšæ³•**:
- ç”Ÿæˆå¤šä¸ªå€™é€‰æ–¹æ¡ˆ
- å¹¶è¡ŒéªŒè¯
- é€‰æ‹©æœ€ä½³æ–¹æ¡ˆ

**å½“å‰Agent**:
- ä¸²è¡Œé‡è¯•2æ¬¡
- æ¯æ¬¡éƒ½æ˜¯å•ä¸€æ–¹æ¡ˆ
- æµªè´¹æ—¶é—´

**å½±å“**:
- å“åº”å»¶è¿Ÿé«˜ï¼ˆ34ç§’ï¼‰
- æˆåŠŸç‡ä½
- ç”¨æˆ·ä½“éªŒå·®

---

## æ ¸å¿ƒé—®é¢˜è¯Šæ–­

### é—®é¢˜1: å­¦ä¹ é—­ç¯ç¼ºå¤± ğŸ”´

**ç—‡çŠ¶**:
- Learneræ”¶é›†äº†å¤§é‡æ•°æ®ï¼Œä½†Planningä»ä¸ä½¿ç”¨
- é”™è¯¯ç‡å±…é«˜ä¸ä¸‹ï¼Œé‡å¤çŠ¯åŒæ ·çš„é”™è¯¯

**æ ¹å› **:
- Planningçš„Promptæ˜¯é™æ€çš„ï¼Œæ²¡æœ‰åŠ¨æ€åŠ è½½ç¤ºä¾‹
- æ²¡æœ‰Few-shot Promptingæœºåˆ¶
- å­¦ä¹ æ•°æ®ä¸æ‰§è¡Œæµç¨‹å®Œå…¨è„±èŠ‚

**å½±å“**:
- æ— æ³•æŒç»­æ”¹è¿›
- æ¯æ¬¡éƒ½ä»é›¶å¼€å§‹
- æµªè´¹äº†å¤§é‡å­¦ä¹ æ•°æ®

### é—®é¢˜2: å•æ¬¡Planningï¼Œç¼ºå°‘æ€ç»´è¿‡ç¨‹ ğŸ”´

**ç—‡çŠ¶**:
- å¤æ‚ä»»åŠ¡ç»å¸¸å‡ºé”™
- å¤±è´¥åä¸çŸ¥é“å“ªé‡Œå‡ºé”™
- ç”¨æˆ·ä¸ç†è§£Agentçš„æ€è€ƒè¿‡ç¨‹

**æ ¹å› **:
- æ²¡æœ‰æ€ç»´é“¾ï¼ˆChain of Thoughtï¼‰
- æ²¡æœ‰ä¸­é—´æ¨ç†æ­¥éª¤
- æ²¡æœ‰"æ€è€ƒ-éªŒè¯-ä¿®æ­£"çš„å¾ªç¯

**å½±å“**:
- å¤æ‚ä»»åŠ¡æˆåŠŸç‡ä½
- è°ƒè¯•å›°éš¾
- ç”¨æˆ·ä¿¡ä»»åº¦ä½

### é—®é¢˜3: ä¸²è¡Œé‡è¯•ï¼Œæµªè´¹å»¶è¿Ÿ ğŸŸ¡

**ç—‡çŠ¶**:
- å¹³å‡å“åº”å»¶è¿Ÿ34ç§’
- Planningå°è¯•2.0æ¬¡
- ç”¨æˆ·ä½“éªŒå·®

**æ ¹å› **:
- æ²¡æœ‰å¹¶è¡Œç”Ÿæˆå¤šä¸ªå€™é€‰æ–¹æ¡ˆ
- ä¸²è¡Œé‡è¯•ï¼Œæ¯æ¬¡éƒ½ç­‰LLMè¿”å›
- æ²¡æœ‰å¿«é€Ÿå¤±è´¥æœºåˆ¶

**å½±å“**:
- å“åº”æ…¢
- æˆæœ¬é«˜ï¼ˆå¤šæ¬¡LLMè°ƒç”¨ï¼‰
- ç”¨æˆ·ä½“éªŒå·®

### é—®é¢˜4: ä¸Šä¸‹æ–‡ç®¡ç†ç®€å• ğŸŸ¡

**ç—‡çŠ¶**:
- é•¿å¯¹è¯ä¸¢å¤±æ—©æœŸä¿¡æ¯
- æ— æ³•è·¨å¤šè½®æ¨ç†
- 20è½®é™åˆ¶å¤ªæ­»

**æ ¹å› **:
- æ²¡æœ‰å¯¹è¯æ‘˜è¦
- æ²¡æœ‰é‡è¦æ€§è¯„åˆ†
- æ²¡æœ‰åˆ†å±‚å­˜å‚¨ï¼ˆçŸ­æœŸ/é•¿æœŸè®°å¿†ï¼‰

**å½±å“**:
- é•¿å¯¹è¯è´¨é‡ä¸‹é™
- æ— æ³•è®°ä½å…³é”®ä¿¡æ¯
- ç”¨æˆ·ä½“éªŒå·®

### é—®é¢˜5: ç¼ºå°‘ä¸»åŠ¨å­¦ä¹  ğŸ”´

**ç—‡çŠ¶**:
- åªèƒ½è¢«åŠ¨æ‰§è¡Œï¼Œæ— æ³•ä¸»åŠ¨æ”¹è¿›
- æ²¡æœ‰A/Bæµ‹è¯•
- æ²¡æœ‰ç”¨æˆ·åé¦ˆé—­ç¯

**æ ¹å› **:
- å­¦ä¹ æœºåˆ¶å®Œå…¨è¢«åŠ¨
- æ²¡æœ‰ä¸»åŠ¨æ¢ç´¢ç­–ç•¥
- æ²¡æœ‰ç”¨æˆ·åé¦ˆæ”¶é›†

**å½±å“**:
- æ— æ³•æŒç»­ä¼˜åŒ–
- æ— æ³•é€‚åº”ç‰¹å®šç”¨æˆ·
- ç³»ç»ŸåƒµåŒ–

---

## ä¼˜åŒ–è·¯çº¿å›¾

### é˜¶æ®µ1: å¿«é€Ÿä¿®å¤ (1-2å‘¨) ğŸŸ¢

#### 1.1 æ¥å…¥Learneråˆ°Planning
**ç›®æ ‡**: è®©å­¦ä¹ æ•°æ®çœŸæ­£è¢«ä½¿ç”¨

**å®æ–½**:
```python
def _plan_with_learning(self, user_input: str) -> Dict:
    # 1. æ£€ç´¢ç›¸å…³ç¤ºä¾‹
    relevant_examples = self._learner.get_relevant_examples(
        skill_name=inferred_skill,
        limit=3
    )

    # 2. æ„å»ºåŒ…å«ç¤ºä¾‹çš„Prompt
    prompt = self._build_planning_prompt(
        user_input=user_input,
        context=context,
        few_shot_examples=relevant_examples  # â† æ–°å¢
    )

    # 3. è°ƒç”¨LLM
    plan = self._agent_llm.chat_json(prompt)
    return plan
```

**æ•ˆæœ**:
- âœ… å‡å°‘é‡å¤é”™è¯¯
- âœ… æé«˜Planningå‡†ç¡®ç‡
- âœ… é™ä½Planningå°è¯•æ¬¡æ•°

#### 1.2 ä¼˜åŒ–åæ€æœºåˆ¶
**ç›®æ ‡**: æé«˜åæ€ä¿®å¤çš„æˆåŠŸç‡

**å®æ–½**:
```python
def reflect_and_fix(self, user_input, plan, errors):
    # 1. åœ¨Promptä¸­åŒ…å«å†å²ä¿®å¤æ¡ˆä¾‹
    similar_cases = self._learner.get_similar_fixes(errors)
    prompt = self._build_reflection_prompt(
        ...,
        few_shot_fixes=similar_cases  # â† æ–°å¢
    )

    # 2. ä¿®å¤åéªŒè¯
    fixed_plan = self._llm.chat_json(prompt)
    if fixed_plan:
        valid, new_errors = self._validator.validate(fixed_plan)  # â† æ–°å¢
        if valid:
            return fixed_plan

    # 3. å¤±è´¥åˆ™è®¾ç½®è¿½é—®
    return self._generate_clarification(errors)
```

**æ•ˆæœ**:
- âœ… æé«˜ä¿®å¤æˆåŠŸç‡
- âœ… å‡å°‘ä¿®å¤æ¬¡æ•°
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### é˜¶æ®µ2: æ¶æ„å‡çº§ (2-4å‘¨) ğŸŸ¡

#### 2.1 å¼•å…¥æ€ç»´é“¾ (Chain of Thought)
**ç›®æ ‡**: è®©Agentå­¦ä¼š"æ€è€ƒ"

**å®æ–½**:
```python
def _plan_with_cot(self, user_input: str) -> Dict:
    # 1. ç”Ÿæˆæ€ç»´é“¾
    cot_prompt = f"""
åˆ†æä»¥ä¸‹ç”¨æˆ·æŸ¥è¯¢ï¼Œç”Ÿæˆè§£é¢˜æ€è·¯ï¼š

ç”¨æˆ·æŸ¥è¯¢: {user_input}

è¯·åˆ†æ­¥æ€è€ƒï¼š
1. ç”¨æˆ·æƒ³è¦ä»€ä¹ˆï¼Ÿ
2. éœ€è¦å“ªäº›ä¿¡æ¯ï¼Ÿ
3. åº”è¯¥è°ƒç”¨å“ªä¸ªæŠ€èƒ½ï¼Ÿ
4. éœ€è¦å“ªäº›å‚æ•°ï¼Ÿ
5. å‚æ•°ä»å“ªé‡Œæ¥ï¼ˆç”¨æˆ·æä¾›/å†å²è®°å¿†/é»˜è®¤å€¼ï¼‰ï¼Ÿ

é€æ­¥æ¨ç†...
"""

    cot = self._agent_llm.chat(cot_prompt)

    # 2. åŸºäºæ€ç»´é“¾ç”Ÿæˆè®¡åˆ’
    plan_prompt = f"""
åŸºäºä»¥ä¸‹æ¨ç†ï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼š

æ¨ç†è¿‡ç¨‹:
{cot}

ç”ŸæˆJSONè®¡åˆ’...
"""

    plan = self._agent_llm.chat_json(plan_prompt)
    return plan
```

**æ•ˆæœ**:
- âœ… å¤æ‚ä»»åŠ¡æˆåŠŸç‡æå‡
- âœ… å¯è§£é‡Šæ€§å¼º
- âœ… è°ƒè¯•å®¹æ˜“

#### 2.2 å¹¶è¡Œç”Ÿæˆå€™é€‰æ–¹æ¡ˆ
**ç›®æ ‡**: é™ä½å»¶è¿Ÿï¼Œæé«˜æˆåŠŸç‡

**å®æ–½**:
```python
import asyncio

async def _plan_parallel(self, user_input: str) -> Dict:
    # 1. å¹¶è¡Œç”Ÿæˆ3ä¸ªå€™é€‰æ–¹æ¡ˆ
    async def generate_candidate(temperature):
        prompt = self._build_planning_prompt(user_input, context)
        return await self._agent_llm.chat_async(prompt, temperature)

    candidates = await asyncio.gather(
        generate_candidate(0.3),  # ä¿å®ˆ
        generate_candidate(0.7),  # å¹³è¡¡
        generate_candidate(1.0),  # åˆ›æ–°
    )

    # 2. å¹¶è¡ŒéªŒè¯
    validations = await asyncio.gather(*[
        self._validate_async(cand) for cand in candidates
    ])

    # 3. é€‰æ‹©æœ€ä½³æ–¹æ¡ˆ
    valid_candidates = [
        (cand, val) for cand, val in zip(candidates, validations)
        if val["is_valid"]
    ]

    if valid_candidates:
        # é€‰æ‹©é”™è¯¯æœ€å°‘çš„
        return min(valid_candidates, key=lambda x: len(x[1]["errors"]))[0]
    else:
        # éƒ½å¤±è´¥ï¼Œé€‰æ‹©ç»¼åˆæœ€å¥½çš„
        return min(validations, key=lambda x: len(x["errors"]))["plan"]
```

**æ•ˆæœ**:
- âœ… å»¶è¿Ÿé™ä½50%
- âœ… æˆåŠŸç‡æå‡
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### é˜¶æ®µ3: æ™ºèƒ½åŒ–å‡çº§ (1-2ä¸ªæœˆ) ğŸ”´

#### 3.1 å¯¹è¯æ‘˜è¦ä¸åˆ†å±‚è®°å¿†
**ç›®æ ‡**: æ”¯æŒé•¿å¯¹è¯ï¼Œä¿ç•™å…³é”®ä¿¡æ¯

**å®æ–½**:
```python
class HierarchicalMemory:
    def __init__(self):
        self.short_term = []  # æœ€è¿‘5è½®ï¼Œå®Œæ•´ç»†èŠ‚
        self.medium_term = []  # æœ€è¿‘20è½®ï¼Œæ‘˜è¦
        self.long_term = []    # æ›´æ—©å¯¹è¯ï¼Œå…³é”®ä¿¡æ¯

    def add_turn(self, turn):
        self.short_term.append(turn)

        # æ¯5è½®ç”Ÿæˆæ‘˜è¦
        if len(self.short_term) >= 5:
            summary = self._summarize(self.short_term)
            self.medium_term.append(summary)
            self.short_term = []

        # æ¯20è½®æå–å…³é”®ä¿¡æ¯
        if len(self.medium_term) >= 4:
            key_info = self._extract_key_info(self.medium_term)
            self.long_term.append(key_info)
            self.medium_term = []

    def get_context(self, query):
        # æ ¹æ®æŸ¥è¯¢æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡
        return {
            "recent": self.short_term,
            "summary": self.medium_term,
            "key_info": self._retrieve_relevant(query, self.long_term)
        }
```

**æ•ˆæœ**:
- âœ… æ”¯æŒæ— é™é•¿åº¦å¯¹è¯
- âœ… ä¿ç•™æ‰€æœ‰å…³é”®ä¿¡æ¯
- âœ… æ™ºèƒ½æ£€ç´¢

#### 3.2 ä¸»åŠ¨å­¦ä¹ ä¸A/Bæµ‹è¯•
**ç›®æ ‡**: æŒç»­ä¼˜åŒ–ï¼Œé€‚åº”ç‰¹å®šç”¨æˆ·

**å®æ–½**:
```python
class ActiveLearner:
    def __init__(self):
        self.strategies = {
            "conservative": {"temperature": 0.3},
            "balanced": {"temperature": 0.7},
            "creative": {"temperature": 1.0}
        }
        self.performance = {k: [] for k in self.strategies}

    def select_strategy(self, user_id: str):
        # ä¸ºæ¯ä¸ªç”¨æˆ·é€‰æ‹©æœ€ä½³ç­–ç•¥
        user_stats = self.get_user_stats(user_id)
        if user_stats["success_rate"] < 0.7:
            return "conservative"
        elif user_stats["avg_latency"] > 5000:
            return "balanced"
        else:
            # æ¢ç´¢æ€§å°è¯•
            return random.choice(["balanced", "creative"])

    def record_outcome(self, strategy, success, latency):
        self.performance[strategy].append({
            "success": success,
            "latency": latency
        })

        # å®šæœŸè¯„ä¼°å¹¶è°ƒæ•´
        if len(self.performance[strategy]) % 100 == 0:
            self._evaluate_and_tune()
```

**æ•ˆæœ**:
- âœ… æŒç»­ä¼˜åŒ–
- âœ… é€‚åº”ç‰¹å®šç”¨æˆ·
- âœ… è‡ªåŠ¨è°ƒä¼˜

#### 3.3 å¤šæ¨¡æ€æ”¯æŒ
**ç›®æ ‡**: æ”¯æŒå›¾æ–‡æ··åˆè¾“å…¥

**å®æ–½**:
```python
@router.post("/chat")
async def chat_multimodal(
    message: str = Form(...),
    image: UploadFile = File(None),
    file: UploadFile = File(None)
):
    # 1. å¤„ç†å›¾åƒ
    if image:
        image_description = await vision_agent.describe(image)
        message = f"{message}\n[å›¾ç‰‡å†…å®¹: {image_description}]"

    # 2. å¤„ç†æ–‡ä»¶
    if file:
        file_analysis = await analysis_agent.analyze(file)
        message = f"{message}\n[æ–‡ä»¶åˆ†æ: {file_analysis}]"

    # 3. ç»§ç»­æ­£å¸¸æµç¨‹
    response = await agent.chat(message)
    return response
```

**æ•ˆæœ**:
- âœ… æ”¯æŒå›¾ç‰‡è¾“å…¥
- âœ… æ”¯æŒæ›´å¤šæ–‡ä»¶ç±»å‹
- âœ… æ›´è‡ªç„¶çš„äº¤äº’

---

## ç«‹å³è¡ŒåŠ¨å»ºè®®

### ä¼˜å…ˆçº§æ’åº

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | éš¾åº¦ | æ•ˆæœ | æ—¶é—´ |
|--------|------|------|------|------|
| ğŸ”´ P0 | æ¥å…¥Learneråˆ°Planning | ä½ | é«˜ | 1å¤© |
| ğŸ”´ P0 | ä¿®å¤åæ€æœºåˆ¶éªŒè¯ | ä½ | ä¸­ | 2å°æ—¶ |
| ğŸŸ¡ P1 | å¼•å…¥æ€ç»´é“¾ | ä¸­ | é«˜ | 3å¤© |
| ğŸŸ¡ P1 | ä¼˜åŒ–ä¸Šä¸‹æ–‡ç®¡ç† | ä¸­ | ä¸­ | 2å¤© |
| ğŸŸ¢ P2 | å¹¶è¡ŒPlanning | é«˜ | ä¸­ | 1å‘¨ |
| ğŸŸ¢ P2 | å¯¹è¯æ‘˜è¦ | ä¸­ | ä¸­ | 3å¤© |
| âšª P3 | ä¸»åŠ¨å­¦ä¹  | é«˜ | é«˜ | 2å‘¨ |
| âšª P3 | å¤šæ¨¡æ€æ”¯æŒ | é«˜ | ä¸­ | 2å‘¨ |

### ç¬¬ä¸€å‘¨è®¡åˆ’

**å‘¨ä¸€-å‘¨äºŒ: P0ä»»åŠ¡**
- [ ] æ¥å…¥Learnerçš„ç¤ºä¾‹åˆ°Planning Prompt
- [ ] æ·»åŠ åæ€åçš„éªŒè¯æ­¥éª¤
- [ ] æµ‹è¯•å¹¶éªŒè¯æ•ˆæœ

**å‘¨ä¸‰-å‘¨å››: P1ä»»åŠ¡**
- [ ] å®ç°æ€ç»´é“¾Planning
- [ ] ä¼˜åŒ–ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆæ·»åŠ æ‘˜è¦ï¼‰
- [ ] A/Bæµ‹è¯•æ–°æ–¹æ¡ˆ

**å‘¨äº”: æ€»ç»“ä¸è§„åˆ’**
- [ ] è¯„ä¼°æœ¬å‘¨æ”¹è¿›æ•ˆæœ
- [ ] è§„åˆ’ä¸‹å‘¨ä»»åŠ¡
- [ ] æ›´æ–°æ–‡æ¡£

---

## æˆåŠŸæŒ‡æ ‡

### çŸ­æœŸç›®æ ‡ (1ä¸ªæœˆ)
- [ ] PlanningæˆåŠŸç‡: 70% â†’ 85%
- [ ] å¹³å‡å“åº”å»¶è¿Ÿ: 34ç§’ â†’ 15ç§’
- [ ] Planningå°è¯•æ¬¡æ•°: 2.0 â†’ 1.3
- [ ] ç”¨æˆ·æ»¡æ„åº¦: N/A â†’ æµ‹é‡å¹¶æå‡

### ä¸­æœŸç›®æ ‡ (3ä¸ªæœˆ)
- [ ] å¤æ‚ä»»åŠ¡æˆåŠŸç‡: 50% â†’ 75%
- [ ] é•¿å¯¹è¯è´¨é‡: å¯ç”¨ â†’ ä¼˜ç§€
- [ ] ä¸»åŠ¨å­¦ä¹ : æ—  â†’ éƒ¨ç½²
- [ ] å¤šæ¨¡æ€: æ—  â†’ åŸºç¡€æ”¯æŒ

### é•¿æœŸç›®æ ‡ (6ä¸ªæœˆ)
- [ ] æ•´ä½“ä½“éªŒ: æ¥è¿‘ChatGPTæ°´å¹³
- [ ] è‡ªé€‚åº”: èƒ½é€‚åº”ç‰¹å®šç”¨æˆ·ä¹ æƒ¯
- [ ] å¤šæ¨¡æ€: å®Œæ•´æ”¯æŒ
- [ ] æŒç»­å­¦ä¹ : è‡ªæˆ‘ä¼˜åŒ–

---

## æ€»ç»“

### å½“å‰æ¶æ„ä¼˜åŠ¿
âœ… è®¾è®¡å®Œå–„ï¼Œç»„ä»¶é½å…¨
âœ… æœ‰å­¦ä¹ ã€åæ€ã€ç›‘æ§æœºåˆ¶
âœ… ä»£ç è´¨é‡é«˜ï¼Œæ˜“äºæ‰©å±•

### æ ¸å¿ƒé—®é¢˜
ğŸ”´ å­¦ä¹ é—­ç¯æœªæ‰“é€š
ğŸ”´ ç¼ºå°‘æ€ç»´é“¾
ğŸŸ¡ ä¸²è¡Œå¤„ç†ï¼Œå»¶è¿Ÿé«˜
ğŸŸ¡ ä¸Šä¸‹æ–‡ç®¡ç†ç®€å•

### ä¼˜åŒ–æ–¹å‘
1. **ç«‹å³**: æ¥å…¥Learnerï¼Œä¿®å¤åæ€
2. **çŸ­æœŸ**: å¼•å…¥æ€ç»´é“¾ï¼Œä¼˜åŒ–ä¸Šä¸‹æ–‡
3. **é•¿æœŸ**: ä¸»åŠ¨å­¦ä¹ ï¼Œå¤šæ¨¡æ€æ”¯æŒ

### é¢„æœŸæ•ˆæœ
å¦‚æœæŒ‰è·¯çº¿å›¾æ‰§è¡Œï¼Œé¢„è®¡ï¼š
- **1ä¸ªæœˆå**: æ¥è¿‘ChatGPTåŸºç¡€æ°´å¹³
- **3ä¸ªæœˆå**: è¶…è¶ŠåŸºç¡€ChatGPTï¼ˆé¢†åŸŸä¸“ç²¾ï¼‰
- **6ä¸ªæœˆå**: è¾¾åˆ°ä¸“ä¸šçº§æ™ºèƒ½ä½“æ°´å¹³

---

**ä¸‹ä¸€æ­¥**: å¼€å§‹å®æ–½P0ä»»åŠ¡
